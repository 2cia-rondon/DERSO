<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Solicitação de Derso - 1º BPM</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h2>Formulário de Solicitação de Derso - 1º BPM</h2>
        <form id="formulario">
            <div class="form-group">
                <label for="email">E-mail:</label>
                <input type="email" class="form-control" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="re">RE (Registro Estatístico):</label>
                <input type="text" class="form-control" id="re" name="re" required>
                <small id="reHelp" class="form-text text-muted">O formato deve ser '1000******', com exatamente 10 dígitos.</small>
            </div>
            <div class="form-group">
                <label for="nome_guerra">Nome de Guerra:</label>
                <input type="text" class="form-control" id="nome_guerra" name="nome_guerra" readonly>
            </div>
            <div class="form-group">
                <label for="funcao">Função:</label>
                <input type="text" class="form-control" id="funcao" name="funcao" readonly>
            </div>
            <div class="form-group">
                <label for="folga">Folga:</label>
                <select class="form-control" id="folga" name="folga" required>
                    <option value="">Selecione</option>
                    <option value="24H">24H</option>
                    <option value="48H">48H</option>
                    <option value="72H">72H</option>
                    <option value="1ª FOLGA">1ª FOLGA</option>
                    <option value="2ª FOLGA">2ª FOLGA</option>
                    <option value="Expediente">EXPEDIENTE</option>
                </select>
            </div>
            <div class="form-group">
                <label for="data_requerida">Data Requerida:</label>
                <input type="text" class="form-control" id="data_requerida" name="data_requerida" required>
            </div>
            <div class="form-group">
                <label>Policiamento:</label><br>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="reforco" name="policiamento" value="reforco">
                    <label class="form-check-label" for="reforco">Reforço</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="rural" name="policiamento" value="rural">
                    <label class="form-check-label" for="rural">Rural</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="tj_cal" name="policiamento" value="tj_cal">
                    <label class="form-check-label" for="tj_cal">TJ CAL</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="emeron_8h" name="policiamento" value="emeron_8h">
                    <label class="form-check-label" for="emeron_8h">Emeron</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="comercio_seguro" name="policiamento" value="comercio_seguro">
                    <label class="form-check-label" for="comercio_seguro">Comércio Seguro</label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Enviar</button>
        </form>
    </div>

    <!-- Adicionando o script do jQuery, Bootstrap JS e do plugin de calendário -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@chenfengyuan/datepicker/dist/datepicker.min.js"></script>
    <script>
        $(document).ready(function(){
            // Inicializando o plugin de calendário
            $('#data_requerida').datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true,
                todayHighlight: true
            });

            // Função para buscar o RE
            $('#re').on('blur', function() {
                const re = $('#re').val();
                if (re && re.length === 10) {
                    fetch(`https://script.google.com/macros/s/AKfycbwV35tNwF7hpbMkIBZ9E4sxUx-WydCoHI4sl-oroBsvbCBAa006rA8tHRwPuQRNzUkxJw/exec?re=${re}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            $('#nome_guerra').val(data.nome);
                            $('#funcao').val(data.funcao);
                        } else {
                            alert(data.error);
                        }
                    })
                    .catch(error => {
                        alert('Erro ao buscar RE: ' + error);
                    });
                } else {
                    alert("Por favor, insira um RE válido.");
                }
            });
        });
    </script>
</body>
</html>
